<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráficos Acelerômetro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="acelerometro-g1" style="padding: 2%;">
        <div style="width: 45%;">
            <h4>Ponto de Controle 1</h4>
            <canvas id="myChart1"></canvas>
        </div>

        <div style="width: 45%;">
            <h4>Ponto de Controle 2</h4>
            <canvas id="myChart2"></canvas>
        </div>

        <div style="width: 45%;">
            <h4>Ponto de Controle 3</h4>
            <canvas id="myChart3"></canvas>
        </div>

        <div style="width: 45%;">
            <h4>Ponto de Controle 4</h4>
            <canvas id="myChart4"></canvas>
        </div>
    </div>

    <script>
        // Função para desenhar a agulha no gráfico
        function drawNeedle(chart, value) {
            const width = chart.width;
            const height = chart.height;
            const ctx = chart.ctx;
            const needleLength = height / 2.5;
            const centerX = width / 2;
            const centerY = height / 2;
            const angle = (Math.PI * (value / 100)) - Math.PI; // Converte o valor em ângulo

            // Limpa qualquer agulha anterior
            ctx.clearRect(0, 0, width, height);

            // Desenha o gráfico de rosca (background)
            chart.draw();

            // Configura e desenha a agulha
            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(angle); // Ajusta a rotação da agulha

            ctx.beginPath();
            ctx.moveTo(0, 0); // Começa do centro do gráfico
            ctx.lineTo(0, -needleLength); // Desenha a agulha para cima
            ctx.lineWidth = 4; // Largura da agulha
            ctx.strokeStyle = 'red'; // Cor da agulha
            ctx.stroke();

            ctx.restore();
        }

        // Configurações para cada gráfico
        const options = {
            responsive: true,
            cutout: '80%', // Faz o gráfico parecer um velocímetro
            rotation: -90, // Começa o gráfico de -90 graus (esquerda)
            circumference: 180, // Limita o gráfico para 180 graus (semi-círculo)
            plugins: {
                tooltip: {
                    enabled: false // Desabilita tooltip
                }
            },
            events: [], // Desabilita eventos de interação com o gráfico
            animation: {
                onComplete: function() {
                    drawNeedle(this, this.data.datasets[0].data[0]);
                }
            }
        };

        // Função para criar um gráfico
        function createAcelerometroChart(ctx, value) {
            const data = {
                labels: ['Valor Atual', 'Restante'],
                datasets: [{
                    data: [value, 100 - value], // Valor fixo e valor restante para completar 100
                    backgroundColor: ['#00ff00', '#e0e0e0'], // Cor do valor e cor de fundo
                    borderWidth: 0
                }]
            };

            return new Chart(ctx, {
                type: 'doughnut', // Tipo do gráfico
                data: data,
                options: options
            });
        }

        // Criação dos gráficos com valores diferentes para cada ponto de controle
        const myChart1 = createAcelerometroChart(document.getElementById('myChart1').getContext('2d'), 75); // Exemplo valor 75%
        const myChart2 = createAcelerometroChart(document.getElementById('myChart2').getContext('2d'), 50); // Exemplo valor 50%
        const myChart3 = createAcelerometroChart(document.getElementById('myChart3').getContext('2d'), 85); // Exemplo valor 85%
        const myChart4 = createAcelerometroChart(document.getElementById('myChart4').getContext('2d'), 30); // Exemplo valor 30%

    </script>

</body>
</html>
